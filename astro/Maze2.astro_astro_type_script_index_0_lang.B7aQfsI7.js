function u(n,e){this.x=n,this.y=e}function V(n){return Math.floor(Math.random()*n)}function x(n){for(let e=n.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1));[n[e],n[r]]=[n[r],n[e]]}return n}function A(n,e){var r,f=n,i=e,c,v,h=["n","s","e","w"],p={n:{y:-1,x:0,o:"s"},s:{y:1,x:0,o:"n"},e:{y:0,x:1,o:"w"},w:{y:0,x:-1,o:"e"}};this.map=function(){return r},this.startCoord=function(){return c},this.endCoord=function(){return v};function d(){r=new Array(i);for(var s=0;s<i;s++){r[s]=new Array(f);for(var l=0;l<f;++l)r[s][l]={n:!1,s:!1,e:!1,w:!1,visited:!1,priorPos:null}}}function a(){for(var s=!1,l=!1,g=1,M=0,b=0,t=new u(0,0),w=f*i;!s;){l=!1,r[t.x][t.y].visited=!0,M>=b&&(x(h),b=Math.round(V(i/8)),M=0),M++;for(var y=0;y<h.length;y++){var S=h[y],C=t.x+p[S].x,k=t.y+p[S].y;if(C>=0&&C<f&&k>=0&&k<i&&!r[C][k].visited){r[t.x][t.y][S]=!0,r[C][k][p[S].o]=!0,r[C][k].priorPos=t,t=new u(C,k),g++,l=!0;break}}l||(t=r[t.x][t.y].priorPos),w==g&&(s=!0)}}function o(){switch(V(4)){case 0:c=new u(0,0),v=new u(i-1,f-1);break;case 1:c=new u(0,f-1),v=new u(i-1,0);break;case 2:c=new u(i-1,0),v=new u(0,f-1);break;case 3:c=new u(i-1,f-1),v=new u(0,0);break}}d(),o(),a()}function R(n,e,r){var f=n.map(),i=r;this.redrawMaze=function(d){i=d,v(),h(n.endCoord())};function c(d,a,o){var s=d*i,l=a*i;e.lineWidth=i/50,o.n===!1&&(e.beginPath(),e.moveTo(s,l),e.lineTo(s+i,l),e.stroke()),o.s===!1&&(e.beginPath(),e.moveTo(s,l+i),e.lineTo(s+i,l+i),e.stroke()),o.e===!1&&(e.beginPath(),e.moveTo(s+i,l),e.lineTo(s+i,l+i),e.stroke()),o.w===!1&&(e.beginPath(),e.moveTo(s,l),e.lineTo(s,l+i),e.stroke())}function v(){for(var d=0;d<f.length;d++)for(var a=0;a<f[d].length;a++)c(d,a,f[d][a])}function h(d){var a=5,o=i/a-2,s=!0;for(let l=0;l<a;l++)for(let g=0;g<a;g++)e.beginPath(),e.rect(d.x*i+g*o+4.5,d.y*i+l*o+4.5,o,o),s?e.fillStyle="rgba(0, 0, 0, 0.8)":e.fillStyle="rgba(255, 255, 255, 0.8)",e.fill(),s=!s}function p(){var d=i*f.length;e.clearRect(0,0,d,d)}p(),v(),h(n.endCoord())}function j(n,e,r,f,i=null){var c=e.getContext("2d"),v,h=0;v=l,i!=null&&(v=g);var p=this,d=n.map(),a=new u(n.startCoord().x,n.startCoord().y),o=r,s=o/2;this.redrawPlayer=function(t){o=t,g(a)};function l(t){c.beginPath(),c.fillStyle="yellow",c.arc((t.x+1)*o-s,(t.y+1)*o-s,s-2,0,2*Math.PI),c.fill(),t.x===n.endCoord().x&&t.y===n.endCoord().y&&(f(h),p.unbindKeyDown())}function g(t){c.drawImage(i,72,29,320,435,t.x*o+4,t.y*o+4,o-8,o-8),t.x===n.endCoord().x&&t.y===n.endCoord().y&&(f(h),p.unbindKeyDown())}function M(t){c.clearRect(t.x*o+1,t.y*o+1,o-2,o-2)}function b(t){var w=d[a.x][a.y],y=t.keyCode;switch(h++,y){case 65:case 37:w.w==!0&&(M(a),a=new u(a.x-1,a.y),v(a));break;case 87:case 38:w.n==!0&&(M(a),a=new u(a.x,a.y-1),v(a));break;case 68:case 39:w.e==!0&&(M(a),a=new u(a.x+1,a.y),v(a));break;case 83:case 40:w.s==!0&&(M(a),a=new u(a.x,a.y+1),v(a));break}}this.bindKeyDown=function(){window.addEventListener("keydown",b,!1);var t=document.getElementById("mazeCanvas");if(t){var w,y,S,C,k=50;t.addEventListener("touchstart",function(L){var B=L.touches[0];w=B.clientX,y=B.clientY},!1),t.addEventListener("touchend",function(L){if(!(!w||!y)){var B=L.changedTouches[0];S=B.clientX,C=B.clientY;var D=S-w,T=C-y;Math.abs(D)>Math.abs(T)?Math.abs(D)>k&&(D>0?b({keyCode:39}):b({keyCode:37})):Math.abs(T)>k&&(T>0?b({keyCode:40}):b({keyCode:38})),w=y=null}},!1)}},this.unbindKeyDown=function(){window.removeEventListener("keydown",b,!1);var t=document.getElementById("mazeCanvas");t&&(t.removeEventListener("touchstart",function(){},!1),t.removeEventListener("touchend",function(){},!1))},v(n.startCoord()),this.bindKeyDown()}var m=document.getElementById("mazeCanvas"),E=m?m.getContext("2d"):null,F,K,H,P,z,I;window.makeMaze=function(){var n=document.getElementById("mazeCanvas");n&&n.classList.add("border"),P?.unbindKeyDown(),I=G(),m&&(z=m.width/I),K=new A(I,I),H=new R(K,E,z),P=new j(K,m,z,q);var e=document.getElementById("mazeContainer");e&&e.style.opacity<"100"&&(e.style.opacity="100")};window.toggleVisablity=function(n){var e=document.getElementById(n);e&&(e.style.visibility=="visible"?e.style.visibility="hidden":e.style.visibility="visible")};function U(){var n=document.createElement("canvas");n.width=100,n.height=100;var e=n.getContext("2d");e&&(e.beginPath(),e.arc(50,50,45,0,2*Math.PI),e.fillStyle="#FFD700",e.fill(),e.strokeStyle="#FFA500",e.lineWidth=3,e.stroke(),F=new Image,F.src=n.toDataURL())}function q(n){var e=document.getElementById("moves");e&&(e.innerHTML="You Moved "+n+" Steps."),window.toggleVisablity("Message-Container");var r=document.getElementById("okBtn");r&&r.focus()}function G(){var n=document.getElementById("diffSelect");return n&&n.options&&n.selectedIndex!==void 0?n.options[n.selectedIndex].value:"15"}function W(){if(!m||!E)return{width:0,height:0};var n=100,e=40,r=window.innerWidth-e,f=window.innerHeight-n-e,i=Math.min(r,f);return i=Math.max(i,300),{width:i,height:i}}window.onload=function(){if(!(!m||!E)){var n=W();E.canvas.width=n.width,E.canvas.height=n.height,z=m.width/I,U();var e=document.getElementById("startMazeBtn");e&&e.addEventListener("click",window.makeMaze);var r=document.getElementById("okBtn");r&&r.addEventListener("click",function(){window.toggleVisablity("Message-Container"),window.makeMaze()})}};window.onresize=function(n){if(!(!m||!E)){var e=W();E.canvas.width=e.width,E.canvas.height=e.height,z=m.width/I,P!=null&&(H.redrawMaze(z),P.redrawPlayer(z))}};
